<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protected Page</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="/public/style.css">
    <link rel="stylesheet" href="/public/profile.css">
    <link rel="stylesheet" href="/public/protected.css">
    <link rel="stylesheet" href="/public/calendar.css">
    
    <script type="module" defer src="/public/profile.js"></script>
    <script type="module" defer src="/public/protected.js"></script>
    <script type="module" defer src="/public/calendar.js"></script>

    
</head>

<body>
    <header>
        <nav>
            <li>
                <a href="/protectedpage">Home</a>
            </li>
            <li>
                <a href="/about">About</a>
            </li>
            <li>
                <a href="/contact">Contact</a>
            </li>
            <li>
                <a class="logout" href="/logout">Logout</a>
            </li>
        </nav>
    </header>
    <main>
        <nav class="sidebar">
            <!-- <button class="save">Update Profile</button> -->
            <button class="showProfile">Show Profile</button>
            <button class="showapi">Show AJAX API</button>
            <button class="showlogin">Show AJAX API II</button>
            <button class="showUsers">Show Users</button>
            
            
        </nav>
        <section class="dashboard">
            <h1>Welcome to the Protected Page</h1>
            <p>Welcome <span class="name"></span></p>
            <button class="start">Start Timer</button>
            <button class="stop">Stop Timer</button>
            <p class="web_worker"></p>
            <!-- <h2>Status: <span class="status"></span></p> -->
            <buton class="logUser">Show SVG Design</buton>   
                <!-- View Section -->
            <div class="myapi"></div>
            <div class="viewapi"></div>
            <a class="lastlink" href="/logout">Logout</a>
        </section> 
    </main>
    <div id="user-info"></div>

    <script>

        async function getUser(){
            try{
                const response = await axios.get('/session', {withCredentials: true});
                const data = response.data.user;
                console.log(data)
                document.getElementById('user-info').textContent = `User: ${data.username}`

            }catch(err){
                console.error(err)
            }
        }

        getUser();
        
        // fetch('/session')
        //     .then(response => response.json())
        //     .then(data => {
        //         document.getElementById('user-info').textContent = `User: ${data.user.name}`;
        //     })
        //     .catch(error => console.error('Error fetching user data:', error));
    </script>
</body>
</html>